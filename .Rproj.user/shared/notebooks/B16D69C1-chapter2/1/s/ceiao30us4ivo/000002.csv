"0","drawBarLinePlot <- function(data, workGb, var) {"
"0","  "
"0","  # 등록연도가 없는 행을 삭제합니다. "
"0","  data <- data[complete.cases(data$regYear), ]"
"0","  "
"0","  if (var == ""growth"") {"
"0","    # 성장예상 데이터가 없는 경우(NODATA) 데이터 플임에서 삭제"
"0","    data <- data[!(data$growth == ""NODATA""), ]"
"0","  }"
"0","  "
"0","  # 빈도테이블을 생성합니다. "
"0","  tbl <- data %>% "
"0","    dplyr::filter(onBoard == workGb & !is.na(eval(expr = parse(text = var)))) %>% "
"0","    select(c('regYear', var)) %>% "
"0","    group_by(regYear, eval(expr = parse(text = var))) %>% "
"0","    summarize(freqen = n()) %>% "
"0","    mutate(rate = (freqen / sum(freqen) * 100) %>% round(digits = 1L)) "
"0","  "
"0","  "
"0","  # 두 번째 컬럼명을 var로 변경합니다. "
"0","  colnames(x = tbl)[2] <- var"
"0","  "
"0","  "
"0","  # 홀수행의 비중을 NA로 치환합니다. "
"0","  rowNums <- seq(from = 1, to = nrow(x = tbl), by = 2)"
"0","  tbl$rate[rowNums] <- NA"
"0","  "
"0","  # ggplot() 함수를 이용하여 막대그래프를 그립니다."
"0","  ggplot(data = tbl, "
"0","         mapping = aes_string(x = 'regYear', y = 'freqen', fill = var)) + "
"0","    geom_bar(stat = 'identity', position = 'dodge') + "
"0","    geom_text(mapping = aes(label = freqen), "
"0","              position = position_dodge(width = 0.9), "
"0","              vjust = -1) + "
"0","    geom_line(mapping = aes_string(x = 'regYear', y = 'rate', color = var, group = var), "
"0","              size = 1.2, "
"0","              stat = 'identity', "
"0","              position = position_dodge(width = 0.9)) +"
"0","    geom_point(mapping = aes_string(x = 'regYear', y = 'rate', color = var, group = var), "
"0","              shape = 21, "
"0","              fill = 'white', "
"0","              stroke = 2.0, "
"0","              size = 2.4, "
"0","              stat = 'identity', "
"0","              position = position_dodge(width = 0.9)) + "
"0","    geom_text(mapping = aes(y = rate, label = rate), "
"0","              fontface = 'bold', "
"0","              position = position_dodge(width = 0.9), "
"0","              vjust = -1.5,"
"0","              hjust = 0.5) + "
"0","    coord_cartesian(ylim = c(0, max(tbl$freqen, tbl$rate, na.rm = TRUE) * 1.1)) +"
"0","    scale_fill_manual(values = c('gray80', 'gray50')) +"
"0","    scale_color_manual(values = c('black', 'red')) +"
"0","    ggtitle(label = str_c('regYear', workGb, var, sep = ' ')) + "
"0","    mytheme + "
"0","    theme(axis.title = element_blank())"
"0","}"
"0",""
"0",""
